# CapitalRX assignment

The `main.tf` file has been completed, and provides a public accessible URL to view the pricing
results. One issue I noticed is that the worldtimeapi.org API is down, i.e. I get a
"connection reset by peer" error whether I call from my laptop or from the Lambda function.
I modified the pricing.py code slightly to catch the resulting exception and just return
that the time is invalid.

## Setup instructions
Steps (requires valid AWS environment credentials):
* Prepare the Python code: `zip pricing.zip pricing.py`
* Run Terraform: `terraform plan && terraform apply`

## Results
**Function URL**: https://kqyq3eytvnfdq35wvyvnkcfv4e0uujww.lambda-url.us-west-1.on.aws/

**Log sample** (includes an earlier error where the SEED was not set in the environment):
```
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|   timestamp   |                                                                                                                                                                                                                                                                                                                                                                                              message                                                                                                                                                                                                                                                                                                                                                                                              |
| 1759427393112 | INIT_REPORT Init Duration: 93.35 ms Phase: invoke Status: error Error Type: Runtime.Unknown                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 1759427393112 | START RequestId: 78d4291f-92e7-4ede-ba46-a65a89b1534d Version: $LATEST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 1759427393118 | END RequestId: 78d4291f-92e7-4ede-ba46-a65a89b1534d                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 1759427393118 | REPORT RequestId: 78d4291f-92e7-4ede-ba46-a65a89b1534d Duration: 104.68 ms Billed Duration: 105 ms Memory Size: 128 MB Max Memory Used: 47 MB Status: error Error Type: Runtime.Unknown                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 1759427646564 | [WARNING] 2025-10-02T17:54:06.564Z  LAMBDA_WARNING: Unhandled exception. The most likely cause is an issue in the function code. However, in rare cases, a Lambda runtime update can cause unexpected function behavior. For functions using managed runtimes, runtime updates can be triggered by a function change, or can be applied automatically. To determine if the runtime has been updated, check the runtime version in the INIT_START log entry. If this error correlates with a change in the runtime version, you may be able to mitigate this error by temporarily rolling back to the previous runtime version. For more information, see https://docs.aws.amazon.com/lambda/latest/dg/runtimes-update.html                                                                        |
| 1759427646565 | [ERROR] KeyError: 'SEED' Traceback (most recent call last):   File "/var/lang/lib/python3.12/importlib/__init__.py", line 90, in import_module     return _bootstrap._gcd_import(name[level:], package, level)   File "<frozen importlib._bootstrap>", line 1387, in _gcd_import   File "<frozen importlib._bootstrap>", line 1360, in _find_and_load   File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked   File "<frozen importlib._bootstrap>", line 935, in _load_unlocked   File "<frozen importlib._bootstrap_external>", line 999, in exec_module   File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed   File "/var/task/pricing.py", line 13, in <module>     seed = os.environ["SEED"]   File "<frozen os>", line 714, in __getitem__ |
| 1759427646579 | INIT_REPORT Init Duration: 97.67 ms Phase: invoke Status: error Error Type: Runtime.Unknown                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 1759427646579 | START RequestId: b1f25c82-690c-4fec-a65a-ccd4aafbd674 Version: $LATEST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 1759427646585 | END RequestId: b1f25c82-690c-4fec-a65a-ccd4aafbd674                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 1759427646585 | REPORT RequestId: b1f25c82-690c-4fec-a65a-ccd4aafbd674 Duration: 111.84 ms Billed Duration: 112 ms Memory Size: 128 MB Max Memory Used: 47 MB Status: error Error Type: Runtime.Unknown                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
```
