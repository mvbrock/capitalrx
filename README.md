# CapitalRX assignment

The `main.tf` file has been completed, and provides a public accessible URL to view the pricing
results. One issue I noticed is that the worldtimeapi.org API is down, i.e. I get a
"connection reset by peer" error whether I call from my laptop or from the Lambda function.
I modified the pricing.py code slightly to catch the resulting exception and just return
that the time is invalid.

## Setup instructions
Steps (requires valid AWS environment credentials):
* Prepare the Python code: `zip pricing.zip pricing.py`
* Run Terraform: `terraform plan && terraform apply`

## Results
**Function URL**: https://kqyq3eytvnfdq35wvyvnkcfv4e0uujww.lambda-url.us-west-1.on.aws/

**Log sample** (includes an earlier error where the SEED was not set in the environment):
```
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|   timestamp   |                                                                                                                                                                                                                                                                                                                                                                                              message                                                                                                                                                                                                                                                                                                                                                                                              |
| 1759427393112 | INIT_REPORT Init Duration: 93.35 ms Phase: invoke Status: error Error Type: Runtime.Unknown                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 1759427393112 | START RequestId: 78d4291f-92e7-4ede-ba46-a65a89b1534d Version: $LATEST                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| 1759427393118 | END RequestId: 78d4291f-92e7-4ede-ba46-a65a89b1534d                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 1759427393118 | REPORT RequestId: 78d4291f-92e7-4ede-ba46-a65a89b1534d Duration: 104.68 ms Billed Duration: 105 ms Memory Size: 128 MB Max Memory Used: 47 MB Status: error Error Type: Runtime.Unknown                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| 1759427646564 | [WARNING] 2025-10-02T17:54:06.564Z  LAMBDA_WARNING: Unhandled exception. The most likely cause is an issue in the function code. However, in rare cases, a Lambda runtime update can cause unexpected function behavior. For functions using managed runtimes, runtime updates can be triggered by a function change, or can be applied automatically. To determine if the runtime has been updated, check the runtime version in the INIT_START log entry. If this error correlates with a change in the runtime version, you may be able to mitigate this error by temporarily rolling back to the previous runtime version. For more information, see https://docs.aws.amazon.com/lambda/latest/dg/runtimes-update.html                                                                        |
| 1759427646565 | [ERROR] KeyError: 'SEED' Traceback (most recent call last):   File "/var/lang/lib/python3.12/importlib/__init__.py", line 90, in import_module     return _bootstrap._gcd_import(name[level:], package, level)   File "<frozen importlib._bootstrap>", line 1387, in _gcd_import   File "<frozen importlib._bootstrap>", line 1360, in _find_and_load   File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked   File "<frozen importlib._bootstrap>", line 935, in _load_unlocked   File "<frozen importlib._bootstrap_external>", line 999, in exec_module   File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed   File "/var/task/pricing.py", line 13, in <module>     seed = os.environ["SEED"]   File "<frozen os>", line 714, in __getitem__ |
| 1759427646579 | INIT_REPORT Init Duration: 97.67 ms Phase: invoke Status: error Error Type: Runtime.Unknown                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 1759429943630 | INIT_START Runtime Version: python:3.12.v88 Runtime Version ARN: arn:aws:lambda:us-west-1::runtime:4af3157c9dfde29be4e8f128147181e8978958ec7ddea506e754af7c3741a0a2      |
| 1759429943761 | START RequestId: 15adb3bf-0bb9-4eb4-8d62-26c7374aad53 Version: $LATEST                                                                                                   |
| 1759429944170 | END RequestId: 15adb3bf-0bb9-4eb4-8d62-26c7374aad53                                                                                                                      |
| 1759429944170 | REPORT RequestId: 15adb3bf-0bb9-4eb4-8d62-26c7374aad53 Duration: 408.27 ms Billed Duration: 537 ms Memory Size: 128 MB Max Memory Used: 51 MB Init Duration: 128.45 ms   |
| 1759429944268 | START RequestId: 231417f7-b4f6-466d-addb-bc1a3c8b6656 Version: $LATEST                                                                                                   |
| 1759429944554 | END RequestId: 231417f7-b4f6-466d-addb-bc1a3c8b6656                                                                                                                      |
| 1759429944554 | REPORT RequestId: 231417f7-b4f6-466d-addb-bc1a3c8b6656 Duration: 284.80 ms Billed Duration: 285 ms Memory Size: 128 MB Max Memory Used: 51 MB                            |
| 1759429946025 | START RequestId: 5be63596-d19b-4604-bd08-86b7b0203e52 Version: $LATEST                                                                                                   |
| 1759429946350 | END RequestId: 5be63596-d19b-4604-bd08-86b7b0203e52                                                                                                                      |
| 1759429946350 | REPORT RequestId: 5be63596-d19b-4604-bd08-86b7b0203e52 Duration: 324.13 ms Billed Duration: 325 ms Memory Size: 128 MB Max Memory Used: 51 MB                            |
| 1759429946418 | START RequestId: 0ba1aa21-a5d7-4fd2-b11e-b3e82dadf0d0 Version: $LATEST                                                                                                   |
| 1759429946752 | END RequestId: 0ba1aa21-a5d7-4fd2-b11e-b3e82dadf0d0                                                                                                                      |
| 1759429946752 | REPORT RequestId: 0ba1aa21-a5d7-4fd2-b11e-b3e82dadf0d0 Duration: 332.82 ms Billed Duration: 333 ms Memory Size: 128 MB Max Memory Used: 51 MB                            |
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
```
